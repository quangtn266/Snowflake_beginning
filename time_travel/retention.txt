SHOW TABLES like '%CUSTOMERS%'

ALTER TABLE OUR_FIRST_DB.PUBLIC.CUSTOMERS
SET DATA_RETENTION_TIME_IN_DAYS = 2;

CREATE OR REPLACE TABLE OUR_FIRST_DB.PUBLIC.ret_example (
    id int,
    first_name string,
    last_name string,
    email string,
    gender string,
    Job string,
    Phone string)
    DATA_RETENTION_TIME_IN_DAYS=3;

SHOW TABLES like '%EX%';

DROP TABLE OUR_FIRST_DB.PUBLIC.ret_example;
UNDROP TABLE OUR_FIRST_DB.PUBLIC.ret_example;

ALTER TABLE OUR_FIRST_DB.PUBLIC.ret_example
SET DATA_RETENTION_TIME_IN_DAYS=0;

// TIME travel cost

SELECT * FROM SNOWFLAKE.ACCOUNT_USAGE.STORAGE_USAGE ORDER BY USAGE_DATE DESC;
SELECT * FROM SNOWFLAKE.ACCOUNT_USAGE.TABLE_STORAGE_METRICS;

// Query time travel storage
SELECT 	ID, 
		TABLE_NAME, 
		TABLE_SCHEMA,
        TABLE_CATALOG,
		ACTIVE_BYTES / (1024*1024*1024) AS STORAGE_USED_GB,
		TIME_TRAVEL_BYTES / (1024*1024*1024) AS TIME_TRAVEL_STORAGE_USED_GB
FROM SNOWFLAKE.ACCOUNT_USAGE.TABLE_STORAGE_METRICS
ORDER BY STORAGE_USED_GB DESC,TIME_TRAVEL_STORAGE_USED_GB DESC;
