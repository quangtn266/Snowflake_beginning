CREATE OR REPLACE TRANSIENT DATABASE TASK_DB;

// PREPARE TABLE
CREATE OR REPLACE TABLE CUSTOMERS (
CUSTOMER_ID INT AUTOINCREMENT START = 1 INCREMENT = 1,
FIRST_NAME VARCHAR(40) DEFAULT 'JENIFER',
CREATE_DATE DATE
)

// CREATE TASK
CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = '1 MINUTE'
    AS
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURRENT_TIMESTAMP);

SHOW TASKS;

// Task starting and suspending
ALTER TASK CUSTOMER_INSERT RESUME;
ALTER TASK CUSTOMER_INSERT SUSPEND;

SELECT * FROM CUSTOMERS



/// USing CRON
CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = '60 MINUTE'
    AS
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURENT_TIMESTAMP);

CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = 'USING CRON 0 7, 10 * * MON-FRI UTC'
    AS
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURENT_TIMESTAMP);  

    # __________ minute (0-59)
# | ________ hour (0-23)
# | | ______ day of month (1-31, or L)
# | | | ____ month (1-12, JAN-DEC)
# | | | | __ day of week (0-6, SUN-SAT, or L)
# | | | | |
# | | | | |
# * * * * *

// Every minute
SCHEDULE = 'USING CRON * * * * * UTC'

// Every day at 6am UTC timezone
SCHEDULE = 'USING CRON 0 6 * * * UTC'

// Every hour starting at 9 AM and ending at 5 PM on Sundays 
SCHEDULE = 'USING CRON 0 9-17 * * SUN America/Los_Angeles'


CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = 'USING CRON 0 9,17 * * * UTC'
    AS 
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURRENT_TIMESTAMP);
