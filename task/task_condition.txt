USE TASK_DB

// prepare table
CREATE OR REPLACE TABLE TASK_DB.PUBLIC.CUSTOMERS (
    CUSTOMER_ID INT AUTOINCREMENT START = 1 INCREMENT =1,
    FIRST_NAME VARCHAR(40) DEFAULT 'JENIFER',
    CREATE_DATE DATE
)

// Create task
CREATE OR REPLACE TASK TASK_DB.PUBLIC.CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = '1 MINUTE'
    WHEN 1=2
    AS
    INSERT INTO TASK_DB.PUBLIC.CUSTOMERS(CREATE_DATE, FIRST_NAME) VALUES(CURRENT_TIMESTAMP, 'MIKE');


CREATE OR REPLACE TASK TASK_DB.PUBLIC.CUSTOMER_INSERT2
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = '1 MINUTE'
    WHEN 1=1
    AS
    INSERT INTO TASK_DB.PUBLIC.CUSTOMERS(CREATE_DATE, FIRST_NAME) VALUES(CURRENT_TIMESTAMP, 'DEBIKA');


    
// TAsk starting and suspending
ALTER TASK TASK_DB.PUBLIC.CUSTOMER_INSERT RESUME;
ALTER TASK TASK_DB.PUBLIC.CUSTOMER_INSERT2 RESUME;

SELECT * FROM TASK_DB.PUBLIC.

select * 
from table(information_schema.task_history())
order by scheduled_time desc;
